# ===============================================
# Traefik Dynamic Configuration - Local Development
# Routes for localhost without SSL
# ===============================================

http:
  routers:
    # Frontend Router (localhost)
    frontend-local:
      rule: "Host(`localhost`)"
      entryPoints:
        - web
      service: frontend-local-service
      priority: 10

    # Backend API Router (localhost/api)
    backend-local:
      rule: "Host(`localhost`) && PathPrefix(`/api`)"
      entryPoints:
        - web
      service: backend-local-service
      priority: 100

  # Services - use container names as hostnames
  services:
    frontend-local-service:
      loadBalancer:
        servers:
          # Use Docker container directly
          - url: "http://immog-frontend:3005"
        passHostHeader: true

    backend-local-service:
      loadBalancer:
        servers:
          - url: "http://immog-nginx:80"
        passHostHeader: true
        healthCheck:
          path: "/api/health"
          interval: "30s"
          timeout: "10s"
